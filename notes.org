* merge rdiff-backup-runner into duplicity-runner to create rdbduprunner
** DONE add checking for both rdiff-backup and duplicity binaries
   CLOSED: [2009-08-27 Thu 12:50]
** DONE create an operations map
   CLOSED: [2009-08-27 Thu 13:35]
   should show the --option to use that function and the two related rdiff-backup and duplicity modes
| command line option  | rdiff-backup               | duplicity              | comments                                                                                                                                                         |
|----------------------+----------------------------+------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| compare              | --compare                  | verify                 | --compare and verify seem to be useful to tell you what's changed, and what would therefore be backed up
| verify               | --verify                   |                        | rdiff-backup's --verify is a check on the sha sums in a backup directory                                                                                         |
| list-oldest          | uses -l to build a list    |                        | no sane mapping                                                                                                                                                  |
| status               | -l                         | destination-status     | mild mapping                                                                                                                                                     |
| calculate-average    | calculate-average          |                        | no dup equiv.                                                                                                                                                    |
| check                | check-destination-dir      | cleanup                | cleans up after a failed backup, in theory (requires --force for duplicity to actually remove files)                                                             |
| cleanup/tidy         | -l and --remove-older-than | remove-older-than      | removes old backups, in rdiff-backup-runner cleanup() is run often to make room, in duplicity-runner tidy() is only called on demand via the command line option |
| remove-oldest        | -l and --remove-older-than | none                   | uses the list of all increments to remove the oldest increment within the constraints  of --host, etc.  only applies to rdiff-backup                             |
| stats                |                            | --nostats              | do or don't print stats at the end of a run, duplicity only                                                                                                      |
| full                 |                            | --full                 | force a full backup, duplicity only                                                                                                                              |
| maxage               | remove-older-than X        | remove-older-than X    | used by cleanup() in rdb and tidy() in dup                                                                                                                       |
| maxinc               | remove-older-than func(X)  | remove-all-but-n-full? | in rdb it's calculated using the increment list, and in dup it /might/ map to all-but-n                                                                          |
| path                 |                            |                        | limits backups acted on to those matching path                                                                                                                   |
| host                 |                            |                        | not implemented in dup, all "hosts" are local                                                                                                                    |
| dest                 |                            |                        | currently matches the tagnamething of the backupdestination, not the destination url/path                                                                        |
| restore              | -r                         | restore                | not implemented in either one!                                                                                                                                   |
| list-increment-sizes | --list-increment-sizes     |                        | not implented in rdb currently                                                                                                                                   |
| list-current-files   | ?                          | list-current-files     | maybe useful but not sensible for rdb mostly                                                                                                                     |
| verbosity            | verbosity                  | verbosity              | perfect mapping (more or less)                                                                                                                                   |
| terminal-verbosity   | terminal-verbosity         |                        | doesn't exist in dup, dup doesn't write logs                                                                                                                     |
|                      |                            |                        |                                                                                                                                                                  |
** DONE do something sane with --verbosity and --terminal-verbosity
   CLOSED: [2009-08-27 Thu 14:25]
** DONE add back a --host option 
   CLOSED: [2009-08-27 Thu 14:39]
** DONE merge cleanup/tidy
   CLOSED: [2009-08-28 Fri 11:59]
** DONE check for the parsing of a config file paramater to set the backup type of a backupdestination
   CLOSED: [2009-08-27 Thu 14:41]
** TODO document all the config options in the sample .rc file
** DONE fix the main "backup" section of the program to do both rdiff-backup and duplicity backups
   CLOSED: [2009-08-27 Thu 15:02]
** DONE create a combined check/cleanup command that does check-dest or cleanup appropriately
   CLOSED: [2009-08-27 Thu 15:28]
** DONE bring back list-oldest and whatever infrastructure that requires
   CLOSED: [2009-08-28 Fri 11:17]
** DONE bring back remove-oldest
   CLOSED: [2009-08-28 Fri 11:31]
** DONE bring back calculate-average
   CLOSED: [2009-08-28 Fri 12:48]
** DONE add a compare/verify that works for both backup types
   CLOSED: [2009-08-28 Fri 16:54]
   it seems that rdiff-backup's --verify option is pretty low-level, and that --compare is closer to duplicity's verify command
*** DONE pass the exclude files to the compare invocation of rdiff-backup and duplicity
    CLOSED: [2009-08-28 Fri 16:53]
--compare and probably verify as well need the names of the exclude files, just like a regular backup
** TODO add a restore command
** TODO add a list-increment-sizes for rdiff-backup
** TODO add a list-current-files for duplicity
** DONE re-organize the use directives
   CLOSED: [2009-08-28 Fri 14:50]
** DONE re-organize the global variables
   CLOSED: [2009-08-28 Fri 14:49]
** DONE re-organize the command line options
   CLOSED: [2009-08-28 Fri 14:49]
** DONE fix disk-space based auto-removal for rdiff-backup types
   CLOSED: [2009-08-28 Fri 12:27]
** TODO there are numerous places where we assume the destination of a rdiff-backup type backup will be a local directory, that should be fixed
** TODO test (and probably fix) the increment listing/removing functions when there are no increments yet
it's probable that it may choke and die if the rdiff-backup destination directories aren't there
** TODO make maxinc and maxage be settable in a BackupDestination block, not just in globally or in BackupSet
** TODO fix all the path creation code to use File::Path or something standard
** TODO revisit the use of --exclude-special-files, it's seems too broad and probably isn't what I want
   it has the option to exclude just fifos, device files and symlinks and I think I would really want to backup symlinks at least!
   *** I have changed exclude-special-files to exclude-device-files, I guess that makes more sense
** TODO determine if the --ssh-no-compression option is really something I want to pass by default
** TODO write some documentation, possibly in pod?
   | command line option   | config file option | global variable or key | comments                                                                                                              |
   | --config-file         | none               | $CONFIG_FILE           | can't be set in the config file for obvious reasons                                                                   |
   | --maxage              | MaxAge             | $MAXAGE maxage         | used to remove old backups                                                                                            |
   | --maxinc              | MaxInc             | $MAXINC maxinc         | used to remove old backups                                                                                            |
   | --verbosity           | Verbosity          | $VERBOSITY             | if set, will be used by both programs                                                                                 |
   | --terminal-verbosity  | TerminalVerbosity  | $TVERBOSITY            | used only by rdiff-backup                                                                                             |
   | --duplicity-binary    | DuplicityBinary    | $DUPLICITY_BINARY      | path to the binary                                                                                                    |
   | --rdiff-backup-binary | RdiffBackupBinary  | $RDIFF_BACKUP_BINARY   | path to the binary                                                                                                    |
   | --exclude-path        | ExcludePath        | $EXCLUDE_PATH          | where to look for exclude files                                                                                       |
   | --facility            | Facility           | $FACILITY              | what syslog facility to use GLOBAL                                                                                    |
   | --level               | Level              | $LOG_LEVEL             | used to limit what's actually output GLOBAL                                                                           |
   | --localhost           | Localhost          | $LOCALHOST             | override the LOCALHOST?  not sure why I thought that would be useful                                                  |
   |                       | GPGPassPhrase      | gpgpassphrase          |                                                                                                                       |
   |                       | AWSAccessKeyID     | awsaccesskeyid         |                                                                                                                       |
   |                       | AWSSecretAccessKey | awssecretaccesskey     |                                                                                                                       |
   |                       | SignKey            | signkey                |                                                                                                                       |
   |                       | EncryptKey         | encryptkey             |                                                                                                                       |
   | --lock-file           | LockFile           | $LOCK_FILE             |                                                                                                                       |
   |                       | BackupDestination  | backupdestination      |                                                                                                                       |
   |                       | BackupSet          |                        | top level object in the @BACKUPS list                                                                                 |
   |                       | Path               | dest or path           | dest if found in a BackupDestination and path if found in a BackupSet, can be specified multiple times in a BackupSet |
   |                       | Type               | btype                  | rdiff-backup or duplicity (default)                                                                                   |
   |                       | MinFree            | minfree                | amount of space to have free on a backupdestination before a backup will be allowed to proceed                        |
   |                       | PercentUsed        | percentused            | must have that much free on a destination before backups are attempted                                                |
   |                       | Host               | host                   | the backup source host                                                                                                |
   |                       | PreRun             | prerun                 |                                                                                                                       |
   |                       | PostRun            | postrun                |                                                                                                                       |
   |                       | Tag                | tag                    | override the "tag"                                                                                                    |
   |                       | Disabled           | disabled               | don't actually make this backup                                                                                       |
   |                       | Compress           | sshcompress            | ???                                                                                                                   |
   |                       | Priority           | priority               | use to affect the order in which backups are run, smaller is sooner                                                   |
   |                       |                    |                        |                                                                                                                       |


   
